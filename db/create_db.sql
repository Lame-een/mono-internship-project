DROP TABLE lyrics;
DROP TABLE song;
DROP TABLE genre;
DROP TABLE album;
DROP TABLE artist;
DROP TABLE serveruser;

CREATE TABLE serveruser(
	userID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT user_pk PRIMARY KEY DEFAULT NEWID(),
	username VARCHAR(128) NOT NULL UNIQUE,
	hash CHAR(344) NOT NULL,
	salt CHAR(44) NOT NULL,
	role CHAR(32) NOT NULL,
	creationTime DATETIME
);

CREATE TABLE artist(
	artistID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT artist_pk PRIMARY KEY DEFAULT NEWID(),
	name VARCHAR(128) NOT NULL,
	creationTime DATETIME
);

CREATE TABLE album(
	albumID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT album_pk PRIMARY KEY DEFAULT NEWID(),
	name VARCHAR(128) NOT NULL,
	NumberOfTracks INTEGER,
	year INTEGER,
	cover VARCHAR(512),
	artistID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT album_fk_artistID REFERENCES artist(artistID),
	creationTime DATETIME
);

CREATE TABLE genre(
	genreID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT genre_pk PRIMARY KEY DEFAULT NEWID(),
	name VARCHAR(128) NOT NULL UNIQUE
);

CREATE TABLE song(
	songID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT song_pk PRIMARY KEY DEFAULT NEWID(),
	name VARCHAR(128) NOT NULL,
	albumID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT song_fk_albumID REFERENCES album(albumID),
	genreID UNIQUEIDENTIFIER 
	CONSTRAINT song_fk_genreID REFERENCES genre(genreID),
	creationTime DATETIME
);

CREATE TABLE lyrics(
	lyricsID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT lyrics_pk PRIMARY KEY DEFAULT NEWID(),
	text VARCHAR(MAX) NOT NULL,
	userID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT lyrics_fk_userID REFERENCES serveruser(userID),
	songID UNIQUEIDENTIFIER NOT NULL
	CONSTRAINT lyrics_fk_songID REFERENCES song(songID),
	creationTime DATETIME
	verified CHAR(1) NOT NULL DEFAULT 'N'
	CONSTRAINT verified_check CHECK (verified in ('Y', 'N')),
);

INSERT INTO serveruser(userID, username, hash, salt, role) VALUES
('00000000-0000-0000-0000-000000000000', 'db', '00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000', '00000000000000000000000000000000000000000000', 'ADMIN');
INSERT INTO serveruser(userID, username, hash, salt, role) VALUES
('f5891b06-704f-4500-b06e-3d14e0c33a4d', 'admin', '+zrvAHv9Lj5JtPyxYGp9azSLSvYF564A6zpdc+2OyjQjEKDB1AEe5iWKOrOV8540NgjMQwIYERPVGMsruhNKRWhEWiuJMmxMH91hqzsBPnLfNacw4mTOTwo4x4tuAQlMHgH70bLDhXNMupFgXJz0gh2/0M91Oaj+0NQGRr56bOOEdxRu4UseJ4aepgUwzxZYPveFOVfKbK3cggwMzVuXBo5kok0ZCexMqudKn8IghepNoeg3E1fq4PU2rTHwt3TnxDRASNAaLQM7AeELK/sFxcq0Yfh4ckmQ/BXP3Df3hDq8n7BDFaNv1qnc2H5zW/J1j4UWeMdB7W1sagbBRB1QLA==', 'dLqtuWzgGWjWN5CaYv/fSF9xV31iw16bBRC/HAvi0hI=', 'ADMIN');


SELECT * FROM serveruser;
SELECT * FROM artist;
SELECT * FROM album;
SELECT * FROM genre;
SELECT * FROM song;
SELECT * FROM lyrics;